{% extends "layouts/layout.html" %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('public', path='stylesheets/login.css') }}">
    <script>
        function onToggleChange() {
            const value = document.getElementById('toggle').checked;
            document.getElementById('loginForm').style.display = value ? 'none' : 'block';
            document.getElementById('registerForm').style.display = value ? 'block' : 'none';
        }
        function checkPassword() {
            const value1 = document.getElementById("passwordR").value;
            const value2 = document.getElementById("confirmPasswordR").value;
            document.getElementById("registerBtn").disabled = value1 !== value2 || value1.length === 0;
        }
    </script>
{% endblock %}

{% block body %}
    <section>
        <div class="loginOrRegister">
            Login
            <label class="switch">
                <input id="toggle" type="checkbox" onchange="onToggleChange()" {% if register_page %} checked {% endif %}>
                <span class="slider round"></span>
            </label>
            Register
        </div>
        <div id="loginForm" {% if register_page %} style="display: none" {% endif %}>
            {% if register_succeed %}
            <p class="success-message">Registration succeed.</p>
            {% endif %}
            {% if login_error %}
            <p class="error-message">Invalid username and/or password.</p>
            {% endif %}
            <form method="post" action="/login">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" />
                <label for="password">Password</label>
                <input type="password" id="password" name="password" />
                <input type='hidden' name='csrf-token' value="{{ csrf_token }}"/>
                <input class="btn submit" type="submit" value="Login" />
                <a href="" onclick="alert('You are a loser !')">Forget password ?</a>
            </form>
        </div>
        <div id="registerForm" {% if not register_page %} style="display: none" {% endif %}>
            {% if register_error %}
            <p class="error-message">Username already used.</p>
            {% endif %}
            <form method="post" action="/register">
                <label for="usernameR">Username</label>
                <input type="text" id="usernameR" name="username" />
                <label for="passwordR">Password</label>
                <input type="password" id="passwordR" name="password" onkeyup="checkPassword()" />
                <label for="confirmPasswordR">Confirm password</label>
                <input type="password" id="confirmPasswordR" name="confirm_password" onkeyup="checkPassword()" />
                <input type='hidden' name='csrf-token' value="{{ csrf_token }}"/>
                <input id="registerBtn" class="btn submit" type="submit" value="Register" disabled />
            </form>
        </div>
    </section>
{% endblock %}
